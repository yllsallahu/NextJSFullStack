#!/bin/bash

echo "üö® URGENT FIX: OAuth & Database Issues"
echo "====================================="
echo ""

echo "üìä CURRENT STATUS:"
echo "‚ùå OAuth: Error 401 - invalid_client"
echo "‚ùå Database: MongoServerSelectionError - connection closed"
echo "‚ùå API: 500 errors on /api/blogs"
echo ""

echo "üîß IMMEDIATE FIXES REQUIRED:"
echo ""

echo "1Ô∏è‚É£ GOOGLE OAUTH FIX (CRITICAL):"
echo "   ‚Ä¢ Problem: Callback URL not configured in Google Cloud Console"
echo "   ‚Ä¢ Go to: https://console.cloud.google.com/"
echo "   ‚Ä¢ Navigate: APIs & Services ‚Üí Credentials"
echo "   ‚Ä¢ Edit your OAuth 2.0 Client ID"
echo "   ‚Ä¢ Add Authorized redirect URI:"
echo "     https://next-js-full-stack-blog.vercel.app/api/auth/callback/google"
echo ""

echo "2Ô∏è‚É£ DATABASE CONNECTION FIX (CRITICAL):"
echo "   ‚Ä¢ Current Error: MongoServerSelectionError - connection closed"
echo "   ‚Ä¢ Go to Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables"
echo "   ‚Ä¢ Update MONGODB_URI to:"
echo ""
echo "MONGODB_URI:"
echo "mongodb+srv://ys68687:yllimali123@clusternext.zlp4afn.mongodb.net/myapp?retryWrites=true&w=majority&ssl=false&appName=NextJSFullStackBlog"
echo ""

echo "3Ô∏è‚É£ VERCEL DEPLOYMENT:"
echo "   ‚Ä¢ After updating environment variables"
echo "   ‚Ä¢ Go to Deployments tab"
echo "   ‚Ä¢ Click 'Redeploy' on latest deployment"
echo ""

echo "üß™ TEST COMMANDS (after fixes):"
echo ""
echo "# Test OAuth providers:"
echo "curl https://next-js-full-stack-blog.vercel.app/api/auth/providers"
echo ""
echo "# Test database connection:"
echo "curl https://next-js-full-stack-blog.vercel.app/api/test-connection"
echo ""
echo "# Test blog API:"
echo "curl https://next-js-full-stack-blog.vercel.app/api/blogs"
echo ""

echo "‚ö†Ô∏è PRIORITY ORDER:"
echo "1. Fix Google OAuth callback URL (highest priority)"
echo "2. Update MONGODB_URI with ssl=false"
echo "3. Redeploy on Vercel"
echo "4. Test all endpoints"
echo ""

echo "‚úÖ EXPECTED RESULTS:"
echo "‚Ä¢ Google sign-in works without 401 error"
echo "‚Ä¢ Database operations successful"
echo "‚Ä¢ Blog loading works"
echo "‚Ä¢ User registration works"
